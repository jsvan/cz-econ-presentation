<!-- SLIDE 2: HIGH-TECH -->
<div class="slide-content">
    <div class="section-number">02</div>
    <div class="section-label">Zajímavý</div>
    <h2>High-tech, Vysoký Růst<span class="gdp-tag blue">5% of GDP</span></h2>
    <br/>
    <div class="chart-container">
        <div class="chart-title">High-Tech export (Miliardy $) — <a href="https://data.worldbank.org/indicator/TX.VAL.TECH.CD" target="_blank" style="color: var(--accent-gold);">World Bank</a></div>
        <div class="chart-wrapper">
            <canvas id="hightechExportsChart"></canvas>
        </div>
    </div>

    <div class="chart-container">
        <div class="chart-title">Růst High-Tech exportu 2015–2024 (Index, 2015=100) — <a href="https://data.worldbank.org/indicator/TX.VAL.TECH.CD" target="_blank" style="color: var(--accent-gold);">World Bank</a> / <a href="https://www.wipo.int/en/web/global-innovation-index/w/blogs/2025/high-tech-exports" target="_blank" style="color: var(--accent-gold);">WIPO</a></div>
        <div class="chart-wrapper">
            <canvas id="hightechGrowthChart"></canvas>
        </div>
    </div>
    <div class="map-container">
        <div class="chart-title">České tech centra</div>
        <svg viewBox="0 0 612.46 350.62" xmlns="http://www.w3.org/2000/svg">
            <image href="https://jsvan.github.io/cz-econ-presentation/czech-republic.svg" width="612.46" height="350.62"/>

            <!-- ALL SHAPES FIRST (so text renders on top) -->

            <!-- Prague -->
            <circle cx="212" cy="137" r="20" fill="#2563eb" opacity="0.3"/>
            <circle cx="212" cy="137" r="8" fill="#2563eb"/>
            <!-- Brno -->
            <circle cx="409" cy="261" r="14" fill="#16a34a" opacity="0.3"/>
            <circle cx="409" cy="261" r="6" fill="#16a34a"/>
            <!-- Foxconn Pardubice -->
            <circle cx="334" cy="143" r="12" fill="#c9a227" opacity="0.3"/>
            <circle cx="334" cy="143" r="5" fill="#c9a227"/>
            <!-- Kutná Hora -->
            <circle cx="288" cy="155" r="8" fill="#c9a227" opacity="0.3"/>
            <circle cx="288" cy="155" r="4" fill="#c9a227"/>
            <!-- Ostrava -->
            <circle cx="558" cy="173" r="10" fill="#7c3aed" opacity="0.3"/>
            <circle cx="558" cy="173" r="5" fill="#7c3aed"/>

            <!-- ALL TEXT LAST (renders on top of shapes) -->

            <!-- Prague labels -->
            <text x="212" y="113" fill="#2563eb" font-size="12" text-anchor="middle" font-weight="bold">Praha</text>
            <text x="212" y="167" fill="#888" font-size="9" text-anchor="middle">700+ startupů</text>
            <text x="212" y="179" fill="#2563eb" font-size="9" text-anchor="middle">Avast, JetBrains, Rohlik</text>
            <!-- Brno labels -->
            <text x="409" y="244" fill="#16a34a" font-size="10" text-anchor="middle" font-weight="bold">Brno</text>
            <text x="409" y="286" fill="#888" font-size="9" text-anchor="middle">Výzkum</text>
            <!-- Foxconn labels -->
            <text x="369" y="138" fill="#c9a227" font-size="10" font-weight="bold">Foxconn</text>
            <text x="369" y="150" fill="#888" font-size="9">Pardubice</text>
            <text x="308" y="170" fill="#888" font-size="9">Kutná Hora</text>
            <!-- Ostrava labels -->
            <text x="558" y="158" fill="#7c3aed" font-size="10" text-anchor="middle" font-weight="bold">Ostrava</text>
            <text x="558" y="193" fill="#888" font-size="9" text-anchor="middle">IT služby</text>
        </svg>
        <div class="map-legend">
            <div class="legend-item"><div class="legend-dot" style="background: #2563eb;"></div>Praha — 700+ startupů</div>
            <div class="legend-item"><div class="legend-dot" style="background: #16a34a;"></div>Brno — výzkum</div>
            <div class="legend-item"><div class="legend-dot" style="background: #c9a227;"></div>Foxconn</div>
            <div class="legend-item"><div class="legend-dot" style="background: #7c3aed;"></div>Ostrava — IT služby</div>
        </div>
    </div>

</div>

<script>
window.initChartsSlide2 = function() {
    createChart('hightechExportsChart', {
        type: 'line',
        data: {
            labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
            datasets: [
                {
                    label: 'Německo',
                    data: [199, 205, 195, 210, 208, 182, 212, 223, 298, 266],
                    borderColor: ChartColors.gold,
                    backgroundColor: 'transparent',
                    tension: 0.3,
                    pointRadius: 4,
                    pointBackgroundColor: ChartColors.gold,
                    borderWidth: 2
                },
                {
                    label: 'Francie',
                    data: [110, 109, 109, 118, 121, 87, 98, 96, 120, 118],
                    borderColor: ChartColors.red,
                    backgroundColor: 'transparent',
                    tension: 0.3,
                    pointRadius: 4,
                    pointBackgroundColor: ChartColors.red,
                    borderWidth: 2
                },
                {
                    label: 'Česko',
                    data: [25, 25, 29, 36, 38, 40, 41, 45, 46, 52],
                    borderColor: ChartColors.blue,
                    backgroundColor: ChartColors.blueAlpha,
                    tension: 0.3,
                    fill: true,
                    pointRadius: 5,
                    pointBackgroundColor: ChartColors.blue,
                    borderWidth: 3
                },
                {
                    label: 'Polsko',
                    data: [17, 17, 19, 22, 20, 20, 24, 28, 30, 32],
                    borderColor: ChartColors.green,
                    backgroundColor: 'transparent',
                    tension: 0.3,
                    pointRadius: 4,
                    pointBackgroundColor: ChartColors.green,
                    borderWidth: 2
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'top',
                    labels: { color: '#888', usePointStyle: true, padding: 20 }
                }
            },
            scales: {
                y: {
                    type: 'logarithmic',
                    title: { display: true, text: 'Miliardy USD' },
                    min: 10,
                    max: 400,
                    grid: { color: '#1a1a1a' },
                    ticks: {
                        callback: function(value) {
                            if ([10, 20, 50, 100, 200, 400].includes(value)) return '$' + value + 'B';
                            return null;
                        }
                    }
                },
                x: { grid: { color: '#1a1a1a' } }
            }
        }
    });

    // Absolute gains for endpoint labels: CZ +$27B, Poland +$15B, Germany +$67B, France +$8B
    const absoluteGains = ['+$27B', '+$15B', '+$67B', '+$8B'];
    const gainColors = [ChartColors.blue, ChartColors.green, ChartColors.gold, ChartColors.red];

    const growthCanvas = document.getElementById('hightechGrowthChart');
    if (growthCanvas) {
        if (window.ChartRegistry) ChartRegistry.destroy('hightechGrowthChart');

        const growthChart = new Chart(growthCanvas, {
            type: 'line',
            data: {
                labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                datasets: [
                    {
                        label: 'Česko',
                        data: [100, 100, 119, 145, 152, 160, 167, 182, 185, 209],
                        borderColor: ChartColors.blue,
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: ChartColors.blue,
                        borderWidth: 3,
                        absoluteGain: '+$27B'
                    },
                    {
                        label: 'Polsko',
                        data: [100, 102, 114, 132, 120, 121, 142, 167, 179, 192],
                        borderColor: ChartColors.green,
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: ChartColors.green,
                        borderWidth: 2,
                        absoluteGain: '+$15B'
                    },
                    {
                        label: 'Německo',
                        data: [100, 103, 98, 105, 104, 91, 106, 112, 149, 134],
                        borderColor: ChartColors.gold,
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: ChartColors.gold,
                        borderWidth: 2,
                        absoluteGain: '+$67B'
                    },
                    {
                        label: 'Francie',
                        data: [100, 99, 99, 107, 110, 79, 89, 87, 109, 108],
                        borderColor: ChartColors.red,
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        pointRadius: 4,
                        pointBackgroundColor: ChartColors.red,
                        borderWidth: 2,
                        absoluteGain: '+$8B'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: {
                    padding: { right: 50 }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: { color: '#888', usePointStyle: true, padding: 20 }
                    },
                    datalabels: {
                        display: function(ctx) {
                            return ctx.dataIndex === ctx.dataset.data.length - 1;
                        },
                        align: 'right',
                        anchor: 'end',
                        offset: 4,
                        color: function(ctx) {
                            return ctx.dataset.borderColor;
                        },
                        font: { weight: 'bold', size: 11 },
                        formatter: function(value, ctx) {
                            return ctx.dataset.absoluteGain;
                        }
                    }
                },
                scales: {
                    y: {
                        title: { display: true, text: 'Index (2015 = 100)' },
                        grid: { color: '#1a1a1a' },
                        min: 70,
                        max: 220
                    },
                    x: { grid: { color: '#1a1a1a' } }
                }
            },
            plugins: [ChartDataLabels]
        });

        if (window.ChartRegistry) ChartRegistry.register('hightechGrowthChart', growthChart);
    }

    createChart('exportCategoriesChart', {
        type: 'bar',
        data: {
            labels: ['Vehicles', 'Electrical/Electronics', 'Machinery/Computers', 'Plastics', 'Iron & Steel', 'Optical/Medical', 'Pharmaceuticals'],
            datasets: [{
                label: 'Export Value ($B)',
                data: [54.1, 53.5, 44.4, 8.4, 7.6, 6.7, 4.4],
                backgroundColor: [
                    ChartColors.gold,  // Vehicles - automotive
                    ChartColors.blue,  // Electrical - tech
                    ChartColors.blue,  // Machinery - tech
                    ChartColors.gray,  // Plastics - traditional
                    ChartColors.gray,  // Iron & Steel - traditional
                    ChartColors.blue,  // Optical/Medical - tech
                    ChartColors.blue   // Pharma - tech
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'y',
            plugins: { legend: { display: false } },
            scales: {
                x: { title: { display: true, text: 'Billion USD (2024)' }, grid: { color: '#1a1a1a' } },
                y: { grid: { display: false }, ticks: { autoSkip: false } }
            }
        }
    });

    createChart('rdSpendingChart', {
        type: 'bar',
        data: {
            labels: ['Sweden', 'Belgium', 'Austria', 'Germany', 'EU Average', 'Czechia', 'Poland', 'Hungary'],
            datasets: [{
                label: 'R&D as % of GDP (2024)',
                data: [3.6, 3.4, 3.3, 3.1, 2.2, 1.82, 1.4, 1.5],
                backgroundColor: [ChartColors.gray, ChartColors.gray, ChartColors.gray, ChartColors.gray, ChartColors.gold, ChartColors.blue, ChartColors.gray, ChartColors.gray],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'y',
            plugins: { legend: { display: false } },
            scales: {
                x: { title: { display: true, text: '% of GDP' }, grid: { color: '#1a1a1a' }, max: 4 },
                y: { grid: { display: false } }
            }
        }
    });
};
</script>
