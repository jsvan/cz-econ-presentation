<!-- SLIDE 4: BEER -->
<div class="slide-content">
    <div class="section-number">05</div>
    <div class="section-label">Liquid Culture</div>
    <h2>Beer: #1 in the World Since 1993 <span class="gdp-tag">~0.5% of GDP*</span></h2>
    <p>Czechs drink <a href="https://vinepair.com/articles/czech-republic-beer-consumption-declining/" class="src" target="_blank"><span class="highlight">126 liters of beer per person per year</span></a>—more than any nation on Earth (~1 pint/day for every adult). Production hit a <a href="https://praguemorning.cz/beer-czech-republic-growth/" class="src" target="_blank">15-year high of 20.9M hectoliters</a> in 2024, with <a href="https://www.czechtradeoffices.com/in/news/czech-beer-exports-set-a-record-in-2024" class="src" target="_blank">record exports of 5.9M hectoliters</a>. The industry has exploded from ~50 breweries in 1990 to <a href="https://en.wikipedia.org/wiki/Beer_in_the_Czech_Republic" class="src" target="_blank">~550 today</a>.</p>

    <div class="chart-container">
        <div class="chart-title">Beer Consumption Per Capita: Czechia vs. Neighbors (Liters/Year) — <a href="https://www.kirinholdings.com/en/newsroom/release/2024/1219_01.html" target="_blank" style="color: var(--accent-gold);">Kirin Holdings 2023</a></div>
        <div class="chart-wrapper">
            <canvas id="beerConsumptionChart"></canvas>
        </div>
    </div>

    <h3>Market Share & Consumption Patterns (2024)</h3>

    <div style="display: flex; justify-content: space-around; align-items: flex-start; gap: 1rem; padding: 1rem 0;">
        <div style="text-align: center; flex: 1.5;">
            <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--accent-gold);">Market Share by Brewing Group</div>
            <div style="height: 220px; position: relative;">
                <canvas id="beerMarketShareChart"></canvas>
            </div>
            <div style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;"><a href="https://www.praguedaily.news/2025/03/11/plzensky-prazdroj-keeps-domestic-sales-stable-in-2024-lager-and-non-alcoholic-beer-on-trend/" target="_blank" class="src">Prague Daily News 2025</a></div>
        </div>
        <div style="text-align: center; flex: 1;">
            <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--accent-blue);">Beer Origin</div>
            <div style="height: 220px; position: relative;">
                <canvas id="beerDomesticChart"></canvas>
            </div>
            <div style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;"><a href="https://brauwelt.com/en/international-report/europe-russia/648174-czech-beer-exports-rise-while-domestic-consumption-declines" target="_blank" class="src">Brauwelt 2024</a></div>
        </div>
        <div style="text-align: center; flex: 1;">
            <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--accent-green);">Where It's Bought</div>
            <div style="height: 220px; position: relative;">
                <canvas id="beerPurchaseChart"></canvas>
            </div>
            <div style="font-size: 0.7rem; color: #666; margin-top: 0.25rem;"><a href="https://www.statista.com/outlook/cmo/alcoholic-drinks/beer/czechia" target="_blank" class="src">Statista 2024</a></div>
        </div>
    </div>

    <div class="map-container">
        <div class="chart-title">Major Brewery Locations</div>
        <svg viewBox="0 0 612.46 350.62" xmlns="http://www.w3.org/2000/svg">
            <image href="czech-republic.svg" width="612.46" height="350.62"/>

            <!-- ALL SHAPES FIRST (so text renders on top) -->

            <!-- Prazdroj (Asahi) - BLUE -->
            <!-- Plzeň - HQ -->
            <circle cx="116" cy="184" r="24" fill="#2563eb" opacity="0.5"/>
            <circle cx="116" cy="184" r="12" fill="#2563eb"/>
            <!-- Velké Popovice -->
            <circle cx="230" cy="159" r="15" fill="#2563eb" opacity="0.4"/>
            <circle cx="230" cy="159" r="7" fill="#2563eb"/>
            <!-- Nošovice (Radegast) -->
            <circle cx="572" cy="194" r="17" fill="#2563eb" opacity="0.4"/>
            <circle cx="572" cy="194" r="9" fill="#2563eb"/>

            <!-- Staropramen (Molson Coors) - RED -->
            <!-- Prague Smíchov -->
            <circle cx="212" cy="137" r="17" fill="#dc2626" opacity="0.5"/>
            <circle cx="212" cy="137" r="9" fill="#dc2626"/>
            <!-- Ostrava (Ostravar) -->
            <circle cx="558" cy="173" r="12" fill="#dc2626" opacity="0.4"/>
            <circle cx="558" cy="173" r="6" fill="#dc2626"/>

            <!-- Heineken - GREEN -->
            <!-- Krušovice -->
            <circle cx="152" cy="123" r="12" fill="#16a34a" opacity="0.5"/>
            <circle cx="152" cy="123" r="6" fill="#16a34a"/>
            <!-- Brno (Starobrno) -->
            <circle cx="409" cy="261" r="15" fill="#16a34a" opacity="0.5"/>
            <circle cx="409" cy="261" r="7" fill="#16a34a"/>
            <!-- Velké Březno -->
            <circle cx="185" cy="54" r="10" fill="#16a34a" opacity="0.4"/>
            <circle cx="185" cy="54" r="5" fill="#16a34a"/>

            <!-- Budvar (State-owned) - GOLD -->
            <circle cx="216" cy="291" r="20" fill="#c9a227" opacity="0.5"/>
            <circle cx="216" cy="291" r="10" fill="#c9a227"/>

            <!-- ALL TEXT LAST (renders on top of shapes) -->

            <!-- Prazdroj labels -->
            <text x="116" y="158" fill="#60a5fa" font-size="10" text-anchor="middle" font-weight="bold">Prazdroj</text>
            <text x="116" y="172" fill="#fff" font-size="9" text-anchor="middle">Plzeň</text>
            <text x="116" y="218" fill="#888" font-size="8" text-anchor="middle">Pilsner Urquell</text>

            <text x="230" y="138" fill="#60a5fa" font-size="10" text-anchor="middle" font-weight="bold">Prazdroj</text>
            <text x="230" y="152" fill="#fff" font-size="9" text-anchor="middle">V. Popovice</text>
            <text x="230" y="182" fill="#888" font-size="8" text-anchor="middle">Kozel</text>

            <text x="572" y="173" fill="#60a5fa" font-size="10" text-anchor="middle" font-weight="bold">Prazdroj</text>
            <text x="572" y="187" fill="#fff" font-size="9" text-anchor="middle">Nošovice</text>
            <text x="572" y="220" fill="#888" font-size="8" text-anchor="middle">Radegast</text>

            <!-- Staropramen labels -->
            <text x="212" y="114" fill="#f87171" font-size="10" text-anchor="middle" font-weight="bold">Staropramen</text>
            <text x="212" y="128" fill="#fff" font-size="9" text-anchor="middle">Prague</text>
            <text x="212" y="163" fill="#888" font-size="8" text-anchor="middle">HQ</text>

            <text x="558" y="153" fill="#f87171" font-size="10" text-anchor="middle" font-weight="bold">Staropramen</text>
            <text x="558" y="167" fill="#fff" font-size="9" text-anchor="middle">Ostrava</text>
            <text x="558" y="193" fill="#888" font-size="8" text-anchor="middle">Ostravar</text>

            <!-- Heineken labels -->
            <text x="152" y="103" fill="#4ade80" font-size="10" text-anchor="middle" font-weight="bold">Heineken</text>
            <text x="152" y="117" fill="#fff" font-size="9" text-anchor="middle">Krušovice</text>

            <text x="409" y="241" fill="#4ade80" font-size="10" text-anchor="middle" font-weight="bold">Heineken</text>
            <text x="409" y="255" fill="#fff" font-size="9" text-anchor="middle">Brno</text>
            <text x="409" y="285" fill="#888" font-size="8" text-anchor="middle">Starobrno</text>

            <text x="185" y="34" fill="#4ade80" font-size="10" text-anchor="middle" font-weight="bold">Heineken</text>
            <text x="185" y="48" fill="#fff" font-size="9" text-anchor="middle">V. Březno</text>

            <!-- Budvar labels -->
            <text x="216" y="271" fill="#fbbf24" font-size="10" text-anchor="middle" font-weight="bold">Budvar</text>
            <text x="216" y="285" fill="#fff" font-size="9" text-anchor="middle">Č. Budějovice</text>
            <text x="216" y="320" fill="#888" font-size="8" text-anchor="middle">State-owned</text>
        </svg>
        <div class="map-legend">
            <div class="legend-item"><div class="legend-dot" style="background: #2563eb;"></div>Plzeňský Prazdroj (Asahi) — <a href="https://www.praguedaily.news/2025/03/11/plzensky-prazdroj-keeps-domestic-sales-stable-in-2024-lager-and-non-alcoholic-beer-on-trend/" target="_blank" class="src">46% share, 3 breweries</a></div>
            <div class="legend-item"><div class="legend-dot" style="background: #dc2626;"></div>Pivovary Staropramen (Molson Coors) — <a href="https://pivovary-staropramen.cz/en/breweries/" target="_blank" class="src">16% share, 2 breweries</a></div>
            <div class="legend-item"><div class="legend-dot" style="background: #16a34a;"></div>Heineken Czechia — <a href="https://www.heinekenceskarepublika.cz/en/" target="_blank" class="src">12% share, 3 breweries</a></div>
            <div class="legend-item"><div class="legend-dot" style="background: #c9a227;"></div>Budějovický Budvar (State-owned) — <a href="https://www.budejovickybudvar.cz/en/brewery" target="_blank" class="src">10% share, only major Czech-owned</a></div>
        </div>
    </div>
</div>

<script>
window.initChartsSlide5 = function() {
    createChart('beerConsumptionChart', {
        type: 'bar',
        data: {
            labels: ['Czechia', 'Austria', 'Germany', 'Poland', 'Ireland', 'UK', 'France'],
            datasets: [{
                label: 'Liters per capita (2023)',
                data: [128, 106, 99, 97, 84, 67, 33],
                backgroundColor: [ChartColors.gold, ChartColors.gray, ChartColors.gray, ChartColors.gray, ChartColors.gray, ChartColors.gray, ChartColors.gray],
                borderColor: [ChartColors.gold, '#666', '#666', '#666', '#666', '#666', '#666'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            indexAxis: 'y',
            plugins: { legend: { display: false } },
            scales: {
                x: { title: { display: true, text: 'Liters per capita' }, grid: { color: '#1a1a1a' } },
                y: { grid: { display: false } }
            }
        }
    });

    // Pie chart label plugin
    const beerPieLabelsPlugin = {
        id: 'beerPieLabels',
        afterDraw: (chart) => {
            const ctx = chart.ctx;
            const meta = chart.getDatasetMeta(0);

            meta.data.forEach((arc, index) => {
                const data = chart.data.datasets[0].data[index];
                if (data < 5) return;

                const label = chart.data.labels[index];
                const centerAngle = (arc.startAngle + arc.endAngle) / 2;
                const radius = (arc.innerRadius + arc.outerRadius) / 2;

                const x = arc.x + Math.cos(centerAngle) * radius * 1.05;
                const y = arc.y + Math.sin(centerAngle) * radius * 1.05;

                ctx.save();
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 11px Source Sans 3, sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.shadowColor = 'rgba(0,0,0,0.8)';
                ctx.shadowBlur = 3;
                ctx.fillText(label, x, y - 6);
                ctx.font = '10px Source Sans 3, sans-serif';
                ctx.fillText(data + '%', x, y + 6);
                ctx.restore();
            });
        }
    };

    const pieOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: { display: false },
            tooltip: {
                callbacks: {
                    label: (ctx) => `${ctx.label}: ${ctx.raw}%`
                }
            }
        }
    };

    // Market share pie chart (2024 data)
    // Colors match the map: Prazdroj=blue, Staropramen=red, Heineken=green, Budvar=gold
    // Prazdroj 46%, Staropramen 16%, Heineken ~12%, Budvar 10%, Others 16%
    createChart('beerMarketShareChart', {
        type: 'pie',
        data: {
            labels: ['Prazdroj', 'Staropramen', 'Heineken', 'Budvar', 'Craft/Other'],
            datasets: [{
                data: [46, 16, 12, 10, 16],
                backgroundColor: ['#2563eb', '#dc2626', '#16a34a', '#c9a227', '#6b7280'],
                borderColor: '#0a0a0a',
                borderWidth: 2
            }]
        },
        plugins: [beerPieLabelsPlugin],
        options: pieOptions
    });

    // Beer origin pie chart - blue domestic, red imported
    createChart('beerDomesticChart', {
        type: 'pie',
        data: {
            labels: ['Domestic', 'Imported'],
            datasets: [{
                data: [97, 3],
                backgroundColor: [ChartColors.blue, '#c75050'],
                borderColor: '#0a0a0a',
                borderWidth: 2
            }]
        },
        plugins: [beerPieLabelsPlugin],
        options: pieOptions
    });

    // Where beer is bought pie chart
    createChart('beerPurchaseChart', {
        type: 'pie',
        data: {
            labels: ['Stores', 'Pubs'],
            datasets: [{
                data: [75, 25],
                backgroundColor: [ChartColors.green, '#065f46'],
                borderColor: '#0a0a0a',
                borderWidth: 2
            }]
        },
        plugins: [beerPieLabelsPlugin],
        options: pieOptions
    });
};
</script>
